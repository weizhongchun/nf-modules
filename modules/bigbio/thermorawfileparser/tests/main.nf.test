nextflow_process {

    name "Test Process THERMORAWFILEPARSER"
    script "../main.nf"
    process "THERMORAWFILEPARSER"
    tag "modules"
    tag "modules_bigbio"
    tag "thermorawfileparser"

    test("Should run stub mode") {

        options "-stub"

        when {
            process {
                """
                input[0] = [
                    [ id: 'test', mzml_id: 'test_sample' ],
                    file('test_sample.raw')
                ]
                """
            }
        }

        then {
            assert process.success
            assert snapshot(process.out).match()
        }
    }

    // TODO: Add integration test with real RAW file when test data repository is available
    // test("Should convert RAW to mzML") {
    //     when {
    //         process {
    //             """
    //             input[0] = [
    //                 [ id: 'test', mzml_id: 'test_sample' ],
    //                 file(params.test_data['proteomics']['thermorawfileparser']['test_raw'], checkIfExists: true)
    //             ]
    //             """
    //         }
    //     }
    //
    //     then {
    //         assert process.success
    //         assert snapshot(process.out.versions).match("versions")
    //         assert process.out.mzmls_converted[0][1] ==~ /.*\.mzML/
    //         assert process.out.log.size() == 1
    //     }
    // }
}

